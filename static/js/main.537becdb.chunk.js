(this["webpackJsonpckit-app"]=this["webpackJsonpckit-app"]||[]).push([[0],{1014:function(e,t,n){},1016:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),s=n(43),o=n.n(s),c=(n(517),n(1030)),a=n(256),u=n(163),l=n(208),d=n(41),p=n(58),f=n(249),h=n(65),b=n(248);function g(){const e=Object(r.useMemo)((()=>({ckitConfig:h.predefined.Aggron,mecuryRPC:"https://testnet.ckb.dev/indexer",ckbRPC:"https://testnet.ckb.dev/rpc",nervosExploreTxUrlPrefix:"https://explorer.nervos.org/aggron/transaction/",nervosExploreAddressUrlPrefix:"https://explorer.nervos.org/aggron/address/"})),[]);return Object(b.useLocalStorage)("localConfig",e)}const m=Object(f.a)((()=>{const[e,t]=Object(r.useState)(),[n]=g();return Object(r.useEffect)((()=>{if(!e){const e=new h.CkitProvider(n.mecuryRPC,n.ckbRPC);e.init({...n.ckitConfig}).then((()=>t(e)))}}),[]),e}));var v=n(250),y=n(162),w=n(270),j=n(269),_=function(e){Object(w.a)(n,e);var t=Object(j.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this,e)).setDescriptor({name:"MetaMask"}),Object(d.e)(Object(y.a)(r),{connectStatus:d.f,signer:d.f}),r}return n}(h.NonAcpPwLockWallet),O=function(e){Object(w.a)(n,e);var t=Object(j.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://unipass.me";return Object(v.a)(this,n),(e=t.call(this,r)).setDescriptor({name:"UniPass"}),Object(d.e)(Object(y.a)(e),{connectStatus:d.f,signer:d.f}),e}return n}(h.UnipassWallet);function x(e){var t=Object(r.useState)(),n=Object(l.a)(t,2),i=n[0],s=n[1];return Object(r.useEffect)((function(){s(void 0),e&&e.getAddress().then(s)}),[e]),{address:i}}var P=Object(f.a)((function(){var e=m.useContainer(),t=Object(p.b)((function(){return[new O]})),n=Object(r.useState)(null),i=Object(l.a)(n,2),s=i[0],o=i[1],c=Object(r.useState)(null),a=Object(l.a)(c,2),u=a[0],f=a[1],h=Object(r.useState)(!1),b=Object(l.a)(h,2),g=b[0],v=b[1],y=Object(r.useCallback)((function(e){v(e),f(null)}),[]),w=Object(r.useMemo)((function(){return null===s?void 0:t[s]}),[s,t]);return Object(r.useEffect)((function(){e&&Object(d.g)((function(){return t.push(new _(e))}))}),[e,t]),Object(r.useEffect)((function(){return Object(d.b)((function(){t&&t.forEach((function(e,n){e.on("connectStatusChanged",(function(n){if("disconnected"===n){var r=t.findIndex((function(e){return"connected"===e.connectStatus}));o(-1===r?null:r)}if("connected"===n){y(!1);var i=t.findIndex((function(t){return t.descriptor.name===e.descriptor.name}));if(-1===i)throw new Error("exception: wallet could not be found");o(i)}})),e.on("error",(function(e){return f({error:e,index:n})}))}))}))}),[y,t]),{currentWalletIndex:s,setCurrentWalletIndex:o,wallets:t,selectedWallet:w,error:u,setError:f,visible:g,setModalVisible:y}})),S=function(e){return e||"unknown"},A=n(1025),C=n(1026),k=n(1028);const E=u.a.div.withConfig({displayName:"Styled__StyledCardWrapper",componentId:"sc-1skmmyb-0"})(["width:360px;padding:24px;margin-bottom:48px;border-radius:16px;background:#fff;box-shadow:3px 3px 8px rgba(0,0,0,0.08);"]);var T=n(81),N=n(6),M=Object(p.a)((function(){var e=P.useContainer(),t=e.selectedWallet,n=e.setModalVisible;return t?Object(N.jsxs)(T.a,{size:"small",type:"primary",disabled:!0,children:["connected to ",t.descriptor.name]}):Object(N.jsx)(T.a,{size:"small",type:"primary",onClick:function(){return n(!0)},children:"Connect"})})),D=n(107),H=n(1029),B=n(1032),I=n(202);class W{constructor(e,t){this.rawAmount=void 0,this.decimals=void 0,this.rawAmount=new I.BigNumber(e),this.decimals=t}static fromRaw(e,t){return new W(e,t)}static fromHumanize(e,t){const n=new I.BigNumber(e).times(10**t);return new W(n,t)}toRawString(){return this.rawAmount.toString()}toHumanizeString(){const e=this.rawAmount.times(10**-this.decimals),t=e.decimalPlaces();return e.decimalPlaces(t,I.BigNumber.ROUND_FLOOR).toFormat().toString()}}function U(e,t){return null!=e&&"object"===typeof e&&t in e}const L=Object(p.a)((()=>{const{selectedWallet:e,setModalVisible:t}=P.useContainer(),[n]=g(),{address:r}=x(null===e||void 0===e?void 0:e.signer);if(!r)return Object(N.jsx)(D.a,{});const i=function(e,t,n=t){if(!t||!n||t<=0||n<=0)throw new Error("start or end is invalid");return e.length<=t+n?e:e.slice(0,t)+"..."+e.slice(-n)}(r,8),s=n.nervosExploreAddressUrlPrefix+r;return Object(N.jsx)("div",{style:{marginTop:"32px",marginBottom:"32px"},children:Object(N.jsxs)(A.a,{children:[Object(N.jsx)(C.a,{span:8,offset:6,children:Object(N.jsx)("div",{style:{textAlign:"center"},children:Object(N.jsx)("a",{href:s,target:"_blank",rel:"noreferrer",children:i})})}),Object(N.jsx)(C.a,{span:8,offset:2,children:Object(N.jsx)("div",{style:{float:"right"},children:Object(N.jsx)(T.a,{size:"small",onClick:()=>t(!0),children:"change"})})})]})})}));var R=n(1035),F=n(1036),Y=n(1037),z=n(1033),V=n(1034),K=u.a.div.withConfig({displayName:"WalletList__ModalBorderWrapper",componentId:"sc-w24eo8-0"})([".ant-list-item{padding:4px 0;margin:4px 0;border-radius:8px;border:1px solid rgba(0,0,0,0);&:hover{border:1px solid rgba(0,0,0,0.2);border-radius:8px;cursor:pointer;}}"]),$=Object(p.a)((function(){var e=P.useContainer(),t=e.wallets,n=e.visible,r=e.setCurrentWalletIndex,i=e.setError,s=e.setModalVisible;return Object(N.jsx)(H.a,{closable:!0,title:"choose wallets",width:312,visible:n,onCancel:function(){return s(!1)},footer:null,children:Object(N.jsx)(K,{children:Object(N.jsx)(z.b,{pagination:!1,dataSource:t,renderItem:function(e,t){return Object(N.jsx)(z.b.Item,{onClick:function(){i(null),"disconnected"===e.connectStatus&&e.connect(),"connected"===e.connectStatus&&(r(t),s(!1))},children:Object(N.jsx)(G,{wallet:e,index:t})})}})})})})),G=Object(p.a)((function(e){var t=e.wallet,n=e.index,r=P.useContainer().error;return"disconnected"===t.connectStatus?Object(N.jsxs)("div",{children:[Object(N.jsxs)(V.b,{children:[S(t.descriptor.name),Object(N.jsx)(R.a,{})]}),r&&r.index===n&&Object(N.jsxs)(k.a.Text,{type:"danger",children:[" ",r.error.message]})]}):"connecting"===t.connectStatus?Object(N.jsx)("div",{children:Object(N.jsxs)(V.b,{children:[S(t.descriptor.name),Object(N.jsx)(F.a,{spin:!0})]})}):Object(N.jsx)("div",{children:Object(N.jsxs)(V.b,{children:[S(t.descriptor.name),Object(N.jsx)(Y.a,{})]})})}));const X=()=>Object(N.jsxs)(E,{children:[Object(N.jsx)("div",{style:{marginBottom:"24px"},children:Object(N.jsxs)(A.a,{children:[Object(N.jsx)(C.a,{span:12,children:Object(N.jsx)(k.a.Title,{level:3,children:" Account "})}),Object(N.jsx)(C.a,{span:12,children:Object(N.jsx)("div",{style:{float:"right",paddingTop:"5px"},children:Object(N.jsx)(M,{})})})]})}),Object(N.jsx)($,{}),Object(N.jsx)(L,{})]});var q=n(68);const J=Object(p.a)((()=>{const[e,t]=Object(r.useState)(!1),[n,i]=Object(r.useState)("invite");return Object(N.jsxs)("div",{style:{marginBottom:"24px"},children:[Object(N.jsxs)(A.a,{children:[Object(N.jsx)(C.a,{span:4,offset:4,children:Object(N.jsx)(T.a,{onClick:()=>{i("invite"),t(!0)},children:"invite"})}),Object(N.jsx)(C.a,{span:4,offset:8,children:Object(N.jsx)(T.a,{onClick:()=>{i("issue"),t(!0)},children:"issue"})})]}),Object(N.jsx)(Z,{visible:e,setVisible:t,operationKind:n})]})})),Z=e=>{const{visible:t,setVisible:n,operationKind:r}=e,{mutateAsync:i,isLoading:s}=function(){const{selectedWallet:e}=P.useContainer(),t=m.useContainer(),[n]=g();return Object(B.a)(["sendIssueTx"],(async n=>{if(null===e||void 0===e||!e.signer)throw new Error("exception: signer undifined");if(!t)throw new Error("exception: ckitProvider undifined");const r={recipient:n.recipient,amount:n.amount};"invite"===n.operationKind?(r.capacityPolicy="createAcp",r.additionalCapacity=h.helpers.CkbAmount.fromCkb(1).toHex(),r.amount="0"):r.capacityPolicy="findAcp";const i=new h.MintSudtBuilder({recipients:[r]},t,e.signer),s=await i.build();return{txHash:await t.sendTransaction(s)}}),{onSuccess({txHash:e}){const t=n.nervosExploreTxUrlPrefix+e;H.a.success({title:"Tx sent",content:Object(N.jsxs)("p",{children:["The transaction was sent, check it in\xa0",Object(N.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:"explorer"}),Object(N.jsxs)("details",{children:[Object(N.jsx)("summary",{children:"transaction id"}),e]})]})})},onError(e){const t=U(e,"message")?String(e.message):"Unknown error";H.a.error({title:"Tx failed",content:t,width:360})}})}(),o="invite"===r?"invite user":"issue udt",c="invite"===r?"user:":"recipient:";return Object(N.jsx)(H.a,{title:o,closable:!0,width:312,visible:t,onCancel:()=>n(!1),footer:null,children:Object(N.jsx)(q.d,{initialValues:{recipient:"",amount:""},validate:e=>({}),onSubmit:(e,{setSubmitting:t})=>{i({recipient:e.recipient,amount:e.amount,operationKind:r}).then((()=>n(!1)))},children:e=>Object(N.jsxs)(q.c,{children:[Object(N.jsxs)("div",{children:[Object(N.jsxs)(A.a,{children:[Object(N.jsx)(C.a,{span:6,children:Object(N.jsx)("label",{htmlFor:"recipient",children:c})}),Object(N.jsx)(C.a,{span:16,children:Object(N.jsx)(q.b,{name:"recipient",type:"text",placeholder:"ckb address"})})]}),Object(N.jsx)(q.a,{name:"recipient",children:e=>Object(N.jsx)(k.a.Text,{type:"danger",children:e})})]}),"issue"===r&&Object(N.jsxs)("div",{style:{marginTop:"24px"},children:[Object(N.jsxs)(A.a,{children:[Object(N.jsx)(C.a,{span:6,children:Object(N.jsx)("label",{htmlFor:"amount",children:"amount:"})}),Object(N.jsx)(C.a,{span:16,children:Object(N.jsx)(q.b,{name:"amount",type:"text"})})]}),Object(N.jsx)(q.a,{name:"amount",children:e=>Object(N.jsx)(k.a.Text,{type:"danger",children:e})})]}),Object(N.jsx)("div",{style:{marginTop:"24px",textAlign:"center"},children:Object(N.jsx)(T.a,{loading:s,onClick:e.submitForm,children:"Submit"})})]})})})},Q=Object(p.a)((()=>{const{selectedWallet:e}=P.useContainer(),t=(null===e||void 0===e?void 0:e.signer)&&(null===e||void 0===e?void 0:e.checkSupported("issue-sudt"));return Object(N.jsx)("div",{children:t&&Object(N.jsxs)(E,{children:[Object(N.jsx)("div",{style:{marginBottom:"24px"},children:Object(N.jsx)(k.a.Title,{level:3,children:" Issue "})}),Object(N.jsx)("div",{style:{textAlign:"center",marginBottom:"36px"},children:"display issued udt info"}),Object(N.jsx)(J,{})]})})}));var ee=n(1027),te=n(144),ne=n(1031);const re=e=>{const{script:t,precision:n}=e,r=m.useContainer(),{selectedWallet:i}=P.useContainer(),{address:s}=x(null===i||void 0===i?void 0:i.signer),o=Object(ne.a)(["queryBalance",t,s],(()=>{if(!r||!s)throw new Error("exception: signer should exist");return t?r.getUdtBalance(s,t):r.getCkbLiveCellsBalance(s)}),{enabled:!!s});return o.isError?Object(N.jsx)(k.a.Text,{type:"danger",children:"error"}):o.data?Object(N.jsx)(k.a.Text,{children:W.fromRaw(o.data,n).toHumanizeString()}):Object(N.jsx)(te.a,{})},ie=e=>{const[t,n]=Object(r.useState)(!1);return Object(N.jsxs)("div",{children:[Object(N.jsx)(T.a,{type:"link",onClick:()=>n(!0),children:"send"}),Object(N.jsx)(se,{visible:t,setVisible:n,assetMeta:e})]})},se=e=>{const{visible:t,setVisible:n,assetMeta:r}=e,{mutateAsync:i,isLoading:s}=function(){const{selectedWallet:e}=P.useContainer(),t=m.useContainer(),[n]=g();return Object(B.a)(["sendTransferTx"],(async n=>{if(null===e||void 0===e||!e.signer)throw new Error("exception: signed undifined");if(!t)throw new Error("exception: ckitProvider undifined");let r;if(n.assetMeta.script){const i=new h.AcpTransferSudtBuilder({recipient:n.recipient,sudt:n.assetMeta.script,amount:n.amount},t,e.signer);r=await i.build()}else{const i={recipient:n.recipient,amount:n.amount,capacityPolicy:"createAcp"},s=new h.TransferCkbBuilder({recipients:[i]},t,e.signer);r=await s.build()}return{txHash:await t.sendTransaction(r)}}),{onSuccess({txHash:e}){const t=n.nervosExploreTxUrlPrefix+e;H.a.success({title:"Tx sent",content:Object(N.jsxs)("p",{children:["The transaction was sent, check it in\xa0",Object(N.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:"explorer"}),Object(N.jsxs)("details",{children:[Object(N.jsx)("summary",{children:"transaction id"}),e]})]})})},onError(e){const t=U(e,"message")?String(e.message):"Unknown error";H.a.error({title:"Tx failed",content:t,width:360})}})}(),o="send "+r.name;return Object(N.jsx)(H.a,{title:o,closable:!0,width:312,visible:t,onCancel:()=>n(!1),footer:null,children:Object(N.jsx)(q.d,{initialValues:{recipient:"",amount:""},validate:e=>({}),onSubmit:(e,{setSubmitting:t})=>{i({recipient:e.recipient,amount:W.fromHumanize(e.amount,r.precision).toRawString(),assetMeta:r}).then((()=>n(!1)))},children:e=>Object(N.jsxs)(q.c,{children:[Object(N.jsxs)("div",{children:[Object(N.jsxs)(A.a,{children:[Object(N.jsx)(C.a,{span:6,children:Object(N.jsx)("label",{htmlFor:"recipient",children:"recipient:"})}),Object(N.jsx)(C.a,{span:16,children:Object(N.jsx)(q.b,{name:"recipient",type:"text",placeholder:"ckb address"})})]}),Object(N.jsx)(q.a,{name:"recipient",children:e=>Object(N.jsx)(k.a.Text,{type:"danger",children:e})})]}),Object(N.jsxs)("div",{style:{marginTop:"24px"},children:[Object(N.jsxs)(A.a,{children:[Object(N.jsx)(C.a,{span:6,children:Object(N.jsx)("label",{htmlFor:"amount",children:"amount:"})}),Object(N.jsx)(C.a,{span:16,children:Object(N.jsx)(q.b,{name:"amount",type:"text"})})]}),Object(N.jsx)(q.a,{name:"amount",children:e=>Object(N.jsx)(k.a.Text,{type:"danger",children:e})})]}),Object(N.jsx)("div",{style:{marginTop:"24px",textAlign:"center"},children:Object(N.jsx)(T.a,{loading:s,onClick:e.submitForm,children:"Submit"})})]})})})},oe=()=>{const[e]=function(){var e=Object(r.useMemo)((function(){return[{name:"ckb",precision:8},{name:"yyds",script:{code_hash:"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4",args:"0x537461ee3e5ebd77ad6bd325e1ff152f298b09453a158a51ebaeaea681499e84",hash_type:"type"},precision:8}]}),[]);return Object(b.useLocalStorage)("assetMeta",e)}(),t=[{render:(e,t)=>Object(N.jsx)("div",{children:t.name})},{render:(e,t)=>Object(N.jsx)(re,{name:t.name,precision:t.precision,script:t.script})},{render:(e,t)=>Object(N.jsx)(ie,{name:t.name,precision:t.precision,script:t.script})}];return Object(N.jsx)("div",{children:Object(N.jsx)(ee.a,{size:"small",showHeader:!1,columns:t,dataSource:e,pagination:{pageSize:5}})})},ce=Object(p.a)((()=>{const{selectedWallet:e}=P.useContainer(),{address:t}=x(null===e||void 0===e?void 0:e.signer);return Object(N.jsx)("div",{children:Object(N.jsxs)(E,{children:[Object(N.jsx)("div",{style:{marginBottom:"12px"},children:Object(N.jsx)(k.a.Title,{level:3,children:" Assets "})}),Object(N.jsxs)("div",{children:[t&&Object(N.jsx)(oe,{}),!t&&Object(N.jsx)(D.a,{})]})]})})}));n(1014);const ae=u.a.div.withConfig({displayName:"App__BodyWrapper",componentId:"sc-1bax71n-0"})(["padding-bottom:32px;min-height:100vh;background:linear-gradient(111.44deg,#a6ded2 0%,#8c99c2 100%);display:flex;align-items:center;justify-content:center;"]);var ue=()=>{const e=new c.a;return Object(N.jsx)(a.a,{client:e,children:Object(N.jsx)(m.Provider,{children:Object(N.jsx)(P.Provider,{children:Object(N.jsx)(ae,{children:Object(N.jsxs)("div",{className:"app",children:[Object(N.jsx)(X,{}),Object(N.jsx)(Q,{}),Object(N.jsx)(ce,{})]})})})})})};var le=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,1038)).then((({getCLS:t,getFID:n,getFCP:r,getLCP:i,getTTFB:s})=>{t(e),n(e),r(e),i(e),s(e)}))};o.a.render(Object(N.jsx)(i.a.StrictMode,{children:Object(N.jsx)(ue,{})}),document.getElementById("root")),le()},137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecipientSameWithSenderError=t.NoEnoughUdtError=t.NoEnoughCkbError=t.NoAvailableCellError=t.CkitError=void 0;class r extends Error{constructor(e,t){super(t),this.metadata=e}}t.CkitError=r;t.NoAvailableCellError=class extends r{constructor(e,t="Cannot find available cell"){super(e,t)}};t.NoEnoughCkbError=class extends r{constructor(e,t=`Udt is not enough, expected minimal amount: ${e.expected}, actual: ${e.actual}`){super(e,t)}};t.NoEnoughUdtError=class extends r{constructor(e,t=`Ckb is not enough, expected minimal amount: ${e.expected}, actual: ${e.actual}`){super(e,t)}};t.RecipientSameWithSenderError=class extends r{constructor(e,t="The recipient and sender cannot be the same one"){super(e,t)}}},177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ScriptManager",{enumerable:!0,get:function(){return r.ScriptManager}}),Object.defineProperty(t,"AbstractProvider",{enumerable:!0,get:function(){return i.AbstractProvider}}),Object.defineProperty(t,"ProviderConfig",{enumerable:!0,get:function(){return i.ProviderConfig}}),Object.defineProperty(t,"InitOptions",{enumerable:!0,get:function(){return i.InitOptions}}),Object.defineProperty(t,"AbstractWallet",{enumerable:!0,get:function(){return s.AbstractWallet}}),Object.defineProperty(t,"createDebugger",{enumerable:!0,get:function(){return o.createDebugger}}),Object.defineProperty(t,"debug",{enumerable:!0,get:function(){return o.debug}});var r=n(518),i=n(519),s=n(533),o=n(540)},194:function(e,t,n){"use strict";function r(e){throw new Error(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unimplemented=function(){throw new Error("unimplemented")},t.asyncSleep=function(e){return new Promise((t=>setTimeout(t,e)))},t.randomHexString=function(e){return"0x"+[...Array(e)].map((()=>Math.floor(16*Math.random()).toString(16))).join("")},t.nonNullable=function(e){if(null==e)throw new Error("Null check failed");return e},t.bytesToHex=function(e){return`0x${[...e].map((e=>e.toString(16).padStart(2,"0"))).join("")}`},t.hexToBytes=function(e){const t=(e=e.startsWith("0x")?e.slice(2):e).match(/.{1,2}/g);if(!t)throw new Error(`cannot parse ${e} into Uint8Array`);return Uint8Array.from(t.map((e=>parseInt(e,16))))},t.boom=r,t.asserts=function(e,t){if(e)return;if("function"===typeof t)throw t();"string"===typeof t&&r(t);if(t instanceof Error)throw t;r()}},197:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pw=void 0;var r=n(16);function i(e){return{code_hash:e.codeHash,args:e.args,hash_type:e.hashType}}function s(e){return new r.Script(e.code_hash,e.args,"type"===e.hash_type?r.HashType.type:r.HashType.data)}const o={fromPwCellDep:function(e){return{dep_type:e.depType,out_point:{tx_hash:e.outPoint.txHash,index:e.outPoint.index}}},toPwCellDep:function(e){return new r.CellDep("dep_group"===e.dep_type?r.DepType.depGroup:r.DepType.code,new r.OutPoint(e.out_point.tx_hash,e.out_point.index))},fromPwCell:function(e){return{cell_output:{capacity:e.capacity.toHexString(),type:e.type?i(e.type):void 0,lock:i(e.lock)},out_point:e.outPoint?{tx_hash:e.outPoint.txHash,index:e.outPoint.index}:void 0,data:e.getData()}},toPwCell:function(e){return function(e){return"object"===typeof e&&null!=e&&"cell_output"in e}(e)?new r.Cell(new r.Amount(e.cell_output.capacity,0),s(e.cell_output.lock),e.cell_output.type?s(e.cell_output.type):void 0,e.out_point?new r.OutPoint(e.out_point.tx_hash,e.out_point.index):void 0,e.data):new r.Cell(new r.Amount(e.output.capacity,0),s(e.output.lock),e.output.type?s(e.output.type):void 0,e.out_point?new r.OutPoint(e.out_point.tx_hash,e.out_point.index):void 0,e.output_data)},toPwScript:s,fromPwScript:i,toPwOutPoint:function(e){return new r.OutPoint(e.tx_hash,e.index)}};t.Pw=o},323:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PwAdapterSigner=void 0;var r=n(16),i=n(197);class s extends r.Signer{constructor(e,t,n=new r.Blake2bHasher){super(n),this.rawSigner=e,this.provider=t}async signMessages(e){const t=[],n=i.Pw.toPwScript(this.provider.parseToScript(await this.rawSigner.getAddress()));for(const r of e)if(r.lock.sameWith(n)){const e=await this.rawSigner.signMessage(r.message);t.push(e)}else t.push("0x");return t}}t.PwAdapterSigner=s},324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPwSenderBuilder=void 0;var r=n(16),i=n(197),s=n(194),o=n(930);class c extends r.Builder{constructor(e){super(Number(e.config.MIN_FEE_RATE)),this.provider=e}getCellDeps(e){return[i.Pw.toPwCellDep(this.provider.getCellDep("SUDT")),i.Pw.toPwCellDep(this.provider.getCellDep("ANYONE_CAN_PAY")),i.Pw.toPwCellDep(this.provider.getCellDep("PW_NON_ANYONE_CAN_PAY")),i.Pw.toPwCellDep(this.provider.getCellDep("SECP256K1_BLAKE160")),...(0,o.getCellDeps)()]}getWitnessPlaceholder(e){const t=(e,t)=>{const n=this.provider.parseToScript(t),r=this.provider.getScriptConfig(e);return r.CODE_HASH===n.code_hash&&r.HASH_TYPE===n.hash_type};return t("SECP256K1_BLAKE160",e)?{lock:"0x"+"0".repeat(130),input_type:"",output_type:""}:t("PW_NON_ANYONE_CAN_PAY",e)||t("PW_NON_ANYONE_CAN_PAY",e)?{lock:"0x"+"0".repeat(132),input_type:"",output_type:""}:t("ANYONE_CAN_PAY",e)?{lock:"0x"+"0".repeat(130),input_type:"",output_type:""}:t("UNIPASS",e)?{lock:"0x"+"0".repeat(2082),input_type:"",output_type:""}:void(0,s.boom)(`Unsupported lock ${e}`)}}t.AbstractPwSenderBuilder=c},475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MercuryProvider=void 0;var r=n(911),i=n(177),s=n(912),o=n(16),c=n(329),a=n(137),u=n(476),l=n(194),d=n(925);function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f extends i.AbstractProvider{constructor(e="http://127.0.0.1:8116",t="http://127.0.0.1:8114"){super(),p(this,"mercury",void 0),p(this,"rpc",void 0),e instanceof s.MercuryClient?this.mercury=e:this.mercury=new s.MercuryClient(e),t instanceof r.RPC?this.rpc=t:this.rpc=new r.RPC(t)}async collectCkbLiveCells(e,t){const n=this.parseToScript(e),r={script:n,script_type:"lock",filter:{output_data_len_range:["0x0","0x1"]}},i=(0,c.from)(this.mercury.get_cells({search_key:r})).pipe((0,c.expand)((e=>this.mercury.get_cells({search_key:r,after_cursor:e.last_cursor})),1),(0,c.takeWhile)((e=>e.objects.length>0)),(0,c.concatMap)((e=>e.objects)),(0,c.filter)((e=>null==e.output.type)),(0,c.scan)(((e,t)=>({cells:e.cells.concat(t),amount:e.amount+BigInt(t.output.capacity)})),{amount:0n,cells:[]}),(0,c.takeWhile)((e=>e.amount<BigInt(t)),!0)),s=await(0,c.lastValueFrom)(i,{defaultValue:{amount:0n,cells:[]}});if(s.amount<BigInt(t))throw new a.NoEnoughCkbError({lock:n,expected:t,actual:u.Amount.from(s.amount).toHex()});return s.cells}async getCkbLiveCellsBalance(e){const t={script:this.parseToScript(e),script_type:"lock",filter:{output_data_len_range:["0x0","0x1"]}},n=(0,c.from)(this.mercury.get_cells({search_key:t})).pipe((0,c.expand)((e=>this.mercury.get_cells({search_key:t,after_cursor:e.last_cursor})),1),(0,c.takeWhile)((e=>e.objects.length>0)),(0,c.concatMap)((e=>e.objects)),(0,c.filter)((e=>null==e.output.type)),(0,c.reduce)(((e,t)=>e+BigInt(t.output.capacity)),0n)),r=await(0,c.lastValueFrom)(n,{defaultValue:"0x0"});return String(r)}getTxPoolInfo(){return this.rpc.tx_pool_info()}getChainInfo(){return this.rpc.get_blockchain_info()}sendTransaction(e){return this.rpc.send_transaction(e)}async collectUdtCells(e,t,n){const r=this.parseToScript(e),i={script:r,filter:{script:t},script_type:"lock"},s=(0,c.from)(this.mercury.get_cells({search_key:i})).pipe((0,c.expand)((e=>this.mercury.get_cells({search_key:i,after_cursor:e.last_cursor})),1),(0,c.takeWhile)((e=>e.objects.length>0)),(0,c.concatMap)((e=>e.objects)),(0,c.scan)(((e,t)=>({cells:e.cells.concat(t),amount:e.amount+BigInt((0,o.toBigUInt128LE)(t.output_data.slice(0,34)))})),{amount:0n,cells:[]}),(0,c.takeWhile)((e=>e.amount<BigInt(n)),!0)),l=await(0,c.lastValueFrom)(s,{defaultValue:{amount:0n,cells:[]}});if(l.amount<BigInt(n))throw new a.NoEnoughUdtError({lock:r,expected:n,actual:u.Amount.from(l.amount).toHex()});return l.cells}getUdtBalance(e,t){const n={script:this.parseToScript(e),filter:{script:t},script_type:"lock"},r=(0,c.from)(this.mercury.get_cells({search_key:n})).pipe((0,c.expand)((e=>this.mercury.get_cells({search_key:n,after_cursor:e.last_cursor})),1),(0,c.takeWhile)((e=>e.objects.length>0)),(0,c.concatMap)((e=>e.objects)),(0,c.reduce)(((e,t)=>e+BigInt((0,o.toBigUInt128LE)(t.output_data.slice(0,34)))),0n));return(0,c.lastValueFrom)(r,{defaultValue:0n}).then((e=>String(e)))}async waitForTransactionCommitted(e,t={}){const{pollIntervalMs:n=1e3,timeoutMs:r=6e4}=t,i=Date.now();let s=null;for(;Date.now()-i<=r;){var o;const t=await this.rpc.get_transaction(e);if("committed"===(null===t||void 0===t||null===(o=t.tx_status)||void 0===o?void 0:o.status)){s=t.transaction;break}await(0,l.asyncSleep)(n)}const c=Number(await this.rpc.get_tip_block_number());for(;Date.now()-i<=r;){const e=await this.mercury.get_tip();if(Number(e.block_number)>=c)break;await(0,l.asyncSleep)(n)}return s}asIndexerCellProvider(){return new d.MercuryCellProvider(this.mercury)}}t.MercuryProvider=f},476:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(924);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}))},477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.byteLenOfSudt=function(e=20){return 40+e+1+32+32+1+16},t.byteLenOfCkbLiveCell=function(e=20){return 40+e+1}},517:function(e,t,n){},518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},519:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProvider=void 0;var r=n(279),i=n(521);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.AbstractProvider=class{constructor(){s(this,"initialized",!1),s(this,"_config",void 0)}get config(){if(!this._config)throw new Error("Cannot find the config, maybe provider is not initialied");return this._config}getScriptConfig(e){return this.config.SCRIPTS[e]}newScript(e,t){const n=this.getScriptConfig(e);if(n)return{code_hash:n.CODE_HASH,args:t,hash_type:n.HASH_TYPE}}getCellDep(e){const t=this.getScriptConfig(e);if(t)return{dep_type:t.DEP_TYPE,out_point:{tx_hash:t.TX_HASH,index:t.INDEX}}}findCellDepByAddress(e){const t=this.parseToScript(e),n=Object.values(this.config.SCRIPTS);if(null==n)return;const r=n.findIndex((e=>(null===e||void 0===e?void 0:e.CODE_HASH)===t.code_hash&&(null===e||void 0===e?void 0:e.HASH_TYPE)===t.hash_type)),i=n[r];return i?{dep_type:i.DEP_TYPE,out_point:{tx_hash:i.TX_HASH,index:i.INDEX}}:void 0}findCellDepByScript(e){return this.findCellDepByAddress(this.parseToAddress(e))}async init(e){if(!this.initialized){if(e){const t=e.MIN_FEE_RATE?e.MIN_FEE_RATE:(await this.getTxPoolInfo()).min_fee_rate;this._config={...e,MIN_FEE_RATE:t}}else{const e="ckb"===(await this.getChainInfo()).chain,t=await this.getTxPoolInfo();this._config=e?{...r.predefined.LINA,MIN_FEE_RATE:t.min_fee_rate}:{...r.predefined.AGGRON4,MIN_FEE_RATE:t.min_fee_rate}}this.initialized=!0}}parseToAddress(e){return(0,i.generateAddress)(e,{config:this.config})}parseToScript(e){return(0,i.parseAddress)(e,{config:this.config})}}},533:function(e,t,n){"use strict";var r=n(209),i=n(534),s=n(283),o=n(210),c=n(211),a=n(212),u=n(213);Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractWallet=t.AbstractConnectableWallet=void 0;var l,d=(l=n(214))&&l.__esModule?l:{default:l};function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(){function e(){var t=this;a(this,e),p(this,"connectStatus","disconnected"),p(this,"signer",void 0),p(this,"emitter",void 0),p(this,"on",(function(e,n){t.emitter.on(e,n)})),this.emitter=new d.default}return u(e,[{key:"disconnect",value:function(){this.onConnectStatusChanged("disconnected"),this.emitter.removeAllListeners()}},{key:"getConnectStatus",value:function(){return this.connectStatus}},{key:"getSigner",value:function(){return this.signer}},{key:"onConnectStatusChanged",value:function(e){this.connectStatus=e,this.emitter.emit("connectStatusChanged",e)}},{key:"onSignerChanged",value:function(e){this.signer=e,this.emitter.emit("signerChanged",e)}},{key:"onSignerDisconnected",value:function(){this.signer=void 0}},{key:"onError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Error("An unknown error occurred in the ".concat(this.constructor.name));this.emitter.emit("error",e)}}]),e}();t.AbstractConnectableWallet=f;var h=function(e){o(n,e);var t=c(n);function n(){var e;return a(this,n),e=t.call(this),p(r(e),"descriptor",{name:"Unknown Wallet",features:[],description:"an unknown wallet"}),e}return u(n,[{key:"setDescriptor",value:function(e){var t=e.name,n=void 0===t?this.descriptor.name:t,r=e.features,i=void 0===r?this.descriptor.features:r,s=e.description,o=void 0===s?this.descriptor.description:s;this.descriptor={name:n,features:i,description:o}}},{key:"onError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Error("An unknown error occurred in the ".concat(this.descriptor.name));i(s(n.prototype),"onError",this).call(this,e)}},{key:"checkSupported",value:function(e){return this.descriptor.features.includes(e)}}]),n}(f);t.AbstractWallet=h},540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDebugger=function(e){e.startsWith("ckit-")||(e="ckit-"+e);return(0,i.default)(e)},t.debug=void 0;var r,i=(r=n(541))&&r.__esModule?r:{default:r};const s=(0,i.default)("ckit");t.debug=s},544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={NonAcpPwLockSigner:!0,NonAcpPwLockWallet:!0};Object.defineProperty(t,"NonAcpPwLockSigner",{enumerable:!0,get:function(){return i.NonAcpPwLockSigner}}),Object.defineProperty(t,"NonAcpPwLockWallet",{enumerable:!0,get:function(){return i.NonAcpPwLockWallet}});var i=n(545),s=n(908);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}))},545:function(e,t,n){"use strict";var r=n(341),i=n(343),s=n(212),o=n(213),c=n(209),a=n(210),u=n(211);Object.defineProperty(t,"__esModule",{value:!0}),t.hashMessage=j,t.InternalNonAcpPwLockSigner=t.NonAcpPwLockSigner=t.NonAcpPwLockWallet=void 0;var l=n(546),d=n(177),p=n(16),f=n(314),h=n(194);function b(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,m(e,t,"get"))}function g(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,m(e,t,"set"),n),n}function m(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){a(n,e);var t=u(n);function n(e){var r;return s(this,n),r=t.call(this),v(c(r),"pwProvider",void 0),v(c(r),"ckitProvider",void 0),r.setDescriptor({features:["issue-sudt"],description:"A non-acp-lock pw lock wallet",name:"NonAcpPwLockWallet"}),r.ckitProvider=e,r.pwProvider=new p.EthProvider((function(e){null!=e?r.onSignerChanged(new w(r.ckitProvider,r.pwProvider)):r.onConnectStatusChanged("disconnected")})),r}return o(n,[{key:"connect",value:function(){var e=this;"disconnected"===this.connectStatus&&(this.onConnectStatusChanged("connecting"),this.pwProvider.init().then((function(){e.onConnectStatusChanged("connected"),e.onSignerChanged(new w(e.ckitProvider,e.pwProvider))}),(function(t){e.onConnectStatusChanged("disconnected"),e.onError(t)})))}}]),n}(d.AbstractWallet);t.NonAcpPwLockWallet=y;var w=function(){function e(t,n){s(this,e),this.ckitProvider=t,this.pwProvider=n}return o(e,[{key:"getAddress",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ckitProvider.getScriptConfig("PW_NON_ANYONE_CAN_PAY"),e.abrupt("return",this.ckitProvider.parseToAddress({hash_type:t.HASH_TYPE,args:this.pwProvider.address.addressString,code_hash:t.CODE_HASH}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(e){return this.pwProvider.sign(e)}}]),e}();function j(e){return(new p.Keccak256Hasher).update("\x19Ethereum Signed Message:\n32").update((0,h.hexToBytes)(e).buffer).digest().serializeJson()}t.NonAcpPwLockSigner=w;var _=new WeakMap,O=function(){function e(t,n){s(this,e),this.ckitProvider=n,_.set(this,{writable:!0,value:void 0}),g(this,_,t)}return o(e,[{key:"getEthAddress",value:function(){var e=(0,f.publicKeyCreate)((0,h.hexToBytes)(b(this,_)),!1).slice(1);return"0x"+(new p.Keccak256Hasher).update(e.buffer).digest().serializeJson().slice(-40)}},{key:"getAddress",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ckitProvider.getScriptConfig("PW_NON_ANYONE_CAN_PAY"),e.abrupt("return",this.ckitProvider.parseToAddress({code_hash:t.CODE_HASH,hash_type:t.HASH_TYPE,args:this.getEthAddress()}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=i(r.mark((function e(t){var n,i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.key.signRecoverable(j(t),b(this,_)),(i=Number.parseInt(n.slice(-2),16))>=27&&(i-=27),s=p.Platform.eth.toString(16).padStart(2,"0"),o=n.slice(2,-2),e.abrupt("return","0x"+s+o+i.toString(16).padStart(2,"0"));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.InternalNonAcpPwLockSigner=O},549:function(e,t){},551:function(e,t){},560:function(e,t){},562:function(e,t){},588:function(e,t){},589:function(e,t){},594:function(e,t){},596:function(e,t){},603:function(e,t){},622:function(e,t){},65:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={helpers:!0,errors:!0,utils:!0,predefined:!0,dummy:!0};Object.defineProperty(t,"predefined",{enumerable:!0,get:function(){return d.predefined}}),t.dummy=t.utils=t.errors=t.helpers=void 0;var i=n(177);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var s=n(544);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=n(910);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var c=n(927);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var a=h(n(476));t.helpers=a;var u=h(n(137));t.errors=u;var l=h(n(194));t.utils=l;var d=n(935),p=h(n(937));function f(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function h(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}t.dummy=p},650:function(e,t){},715:function(e,t){},826:function(e,t){},908:function(e,t,n){"use strict";var r=n(209),i=n(210),s=n(211),o=n(212),c=n(213);Object.defineProperty(t,"__esModule",{value:!0}),t.UnipassWallet=t.UnipassSigner=void 0;var a,u=n(177),l=(a=n(909))&&a.__esModule?a:{default:a};function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(){function e(t){o(this,e),this.unipass=t}return c(e,[{key:"getAddress",value:function(){return Promise.resolve(this.unipass.address.toCKBAddress())}},{key:"signMessage",value:function(e){return this.unipass.sign(e)}}]),e}();t.UnipassSigner=p;var f=function(e){i(n,e);var t=s(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://unipass.me";return o(this,n),(e=t.call(this)).uri=i,d(r(e),"unipassConnector",void 0),e.setDescriptor({name:"UnipassWallet",description:"connect to blockchain with an email",features:["acp"]}),e.unipassConnector=new l.default,e}return c(n,[{key:"connect",value:function(){var e=this;this.onConnectStatusChanged("connecting"),this.unipassConnector.init().then((function(){e.onConnectStatusChanged("connected"),e.onSignerChanged(new p(e.unipassConnector))}))}}]),n}(u.AbstractWallet);t.UnipassWallet=f},909:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(16);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){localStorage.setItem("__unipass__",JSON.stringify(e))}class o extends r.Provider{get email(){return this._email}get recovery(){return this._recovery}constructor(e="https://unipass.me"){super(r.Platform.ckb),this.UNIPASS_BASE=e,i(this,"_email",void 0),i(this,"_recovery",void 0),i(this,"msgHandler",void 0)}async init(){return new Promise((e=>{const t=function(){const e=localStorage.getItem("__unipass__");if(e)return JSON.parse(e)}();if(console.log(t,"-----"),t)this._email=t.email,this.address=new r.Address(t.address,r.AddressType.ckb),e(this);else{const{uniFrame:t}=a("login",`${this.UNIPASS_BASE}/#/login`,(()=>{t.contentWindow&&t.contentWindow.postMessage({upact:"UP-LOGIN"},this.UNIPASS_BASE)}));this.msgHandler=n=>{if("object"===typeof n.data&&"upact"in n.data){const i=n.data;if("UP-LOGIN"===i.upact){const{pubkey:n,email:o}=i.payload,c=l(n);this.address=new r.Address(c,r.AddressType.ckb),console.log("address",this.address),s({email:o,pubkey:n,address:c}),this._email=o,this.msgHandler&&window.removeEventListener("message",this.msgHandler),t&&u(t),e(this)}else"UP-CLOSE"===i.upact&&(t&&u(t),e(this))}},window.addEventListener("message",this.msgHandler,!1)}}))}async recover(){return console.log("[UnipassProvider] to recover"),new Promise((e=>{const{uniFrame:t}=a("login",`${this.UNIPASS_BASE}/#/login`,(()=>{t.contentWindow&&t.contentWindow.postMessage({upact:"UP-RECOVERY"},this.UNIPASS_BASE)}));this.msgHandler=n=>{if("object"===typeof n.data&&"upact"in n.data){const i=n.data;if("UP-LOGIN"===i.upact){const{pubkey:n,email:o,recovery:c}=i.payload,a=l(n);this.address=new r.Address(a,r.AddressType.ckb),console.log("address",this.address),s({email:o,pubkey:n,address:a}),this._email=o,this._recovery=c,this.msgHandler&&window.removeEventListener("message",this.msgHandler),t&&u(t),e(this)}else"UP-CLOSE"===i.upact&&(t&&u(t),e(this))}},window.addEventListener("message",this.msgHandler,!1)}))}sign(e){return console.log("[UnipassProvider] message to sign",e),new Promise((t=>{const{uniFrame:n}=a("sign",`${this.UNIPASS_BASE}/#/sign`);this.msgHandler=i=>{if("object"===typeof i.data&&"upact"in i.data){const o=i.data;if("UP-SIGN"===o.upact){let e;e="string"==typeof o.payload?o.payload:JSON.stringify(o.payload),console.log("[Sign] signature: ",e),this.msgHandler&&window.removeEventListener("message",this.msgHandler),n&&u(n),"string"==typeof o.payload?t(`0x01${e.replace("0x","")}`):t(e)}else if("UP-READY"===o.upact){console.log("[UnipassProvider] sign READY");const t={upact:"UP-SIGN",payload:e};n.contentWindow&&n.contentWindow.postMessage(t,this.UNIPASS_BASE),console.log("[UnipassProvider] opend")}else if("UP-LOGIN"===o.upact){const{pubkey:e,email:i}=o.payload,c=l(e);this.address=new r.Address(c,r.AddressType.ckb),s({email:i,pubkey:e,address:c}),this._email=i,this.msgHandler&&window.removeEventListener("message",this.msgHandler),n&&u(n),t("0x")}else"UP-CLOSE"===o.upact&&(n&&u(n),t("N/A"))}},window.addEventListener("message",this.msgHandler,!1)}))}close(){this.msgHandler&&window.removeEventListener("message",this.msgHandler)}}let c;function a(e,t,n){c&&u(c),document.body.style.margin="0",document.body.style.height="100%",document.body.style.overflow="hidden",c=document.createElement("iframe"),c.src=t,c.style.width="100%",c.style.height="100%",c.style.zIndex="2147483649",c.style.position="absolute",c.style.backgroundColor="rgba(0,0,0,.65)";const{left:r,top:i}=document.documentElement.getBoundingClientRect();return c.style.left=`${r}px`,c.style.top=-i+"px",c.setAttribute("scrolling","no"),c.setAttribute("frameborder","no"),n&&(c.onload=n),document.body.appendChild(c),{uniFrame:c}}function u(e){console.log("[UnipassProvider] close frame"),e.remove(),console.log("[UnipassProvider] frame.remove"),document.body.style.removeProperty("overflow"),console.log("[UnipassProvider] document.body.style.removeProperty()")}function l(t){const n=e.from(t.replace("0x",""),"hex"),i=(new r.Blake2bHasher).update(n.buffer).digest().serializeJson().slice(0,42);return new r.Script("0x124a60cd799e1fbca664196de46b3f7f0ecb7138133dcaea4893c51df5b02be6",i,r.HashType.type).toAddress((0,r.getDefaultPrefix)()).toCKBAddress()}t.default=o}).call(this,n(10).Buffer)},910:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(475);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var i=n(926);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}))},912:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MercuryClient=void 0;var r=n(913);t.MercuryClient=class{constructor(e){var t,n,i;i=void 0,(n="client")in(t=this)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i;const s=new r.HTTPTransport(e,{headers:{"content-type":"application/json"}});this.client=new r.Client(new r.RequestManager([s]))}get_cells(e){const{search_key:t,order:n="asc",limit:r="0x3e8",after_cursor:i}=e;return this.client.request({method:"get_cells",params:[t,n,r,i]})}get_tip(){return this.client.request({method:"get_tip"})}}},924:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CkbAmount=t.Amount=void 0;var r=n(202);class i{static from(e){return new i("bigint"===typeof e?String(e):e)}constructor(e,t=0){var n,i,s;this.decimals=t,s=void 0,(i="raw")in(n=this)?Object.defineProperty(n,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[i]=s,this.raw=new r.BigNumber(e)}humanize(e){const{decimalPlaces:t=1/0,separator:n=!0}=e||{},i=this.raw.times(10**-this.decimals),s=i.decimalPlaces(),o=i.decimalPlaces(Math.min(s,t),r.BigNumber.ROUND_FLOOR);return n?o.toFormat():o.toString()}setVal(e){return"function"===typeof e?(this.raw=e(this.raw),this):(this.raw=new r.BigNumber(e),this)}toString(e){return this.raw.toString(e)}toHex(){return"0x"+this.toString(16)}equals(e){return e instanceof i?e.toString()===this.toString():this.toString()===new r.BigNumber(e).toString()}}t.Amount=i;class s extends i{constructor(e){super(e,8)}static fromCkb(e){return new s(new r.BigNumber(e).times(10**8))}static fromShannon(e){return new s(e)}}t.CkbAmount=s},925:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MercuryCellProvider=void 0;t.MercuryCellProvider=class{constructor(e){this.mercury=e}collector(e){const{lock:t,type:n}=e;let r;if(void 0!==t)r={script:t,script_type:"lock"},void 0!=n&&"empty"!==n&&(r.filter={script:n});else{if(void 0==n||"empty"==n)throw new Error(`should specify either type or lock in queries, queries now: ${JSON.stringify(e)}`);r={script:n,script_type:"type"}}const i=e.data||"0x",s=this.mercury;return{collect:()=>({async*[Symbol.asyncIterator](){for(;;){const e=(await s.get_cells({search_key:r})).objects;for(const t of e)"any"!==i&&i!==t.output_data||(yield{cell_output:t.output,data:t.output_data,out_point:t.out_point,block_number:t.block_number});if(e.length<100)break}}})}}}},926:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CkitProvider=void 0;var r=n(178),i=n(475);class s extends i.MercuryProvider{get config(){return super.config}init(e){return super.init(e)}getScriptConfig(e){const t=super.getScriptConfig(e);if(!t)throw new Error(`cannot find the ${e} script config, maybe init failed`);return t}newScript(e,t="0x"){const n=super.newScript(e,t);if(!n)throw new Error(`cannot find the ${e} script config, maybe init failed`);return n}newSudtScript(e){const t=r.utils.computeScriptHash(this.parseToScript(e));return this.newScript("SUDT",t)}getCellDep(e){const t=super.getCellDep(e);if(!t)throw new Error(`cannot find the ${e} script config, maybe init failed`);return t}}t.CkitProvider=s},927:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(928);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var i=n(931);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var s=n(933);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}))},928:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AcpTransferSudtBuilder=void 0;var r=n(16),i=n(137),s=n(323),o=n(929);t.AcpTransferSudtBuilder=class{constructor(e,t,n){var r,i,s;this.options=e,this.provider=t,this.signer=n,s=void 0,(i="builder")in(r=this)?Object.defineProperty(r,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[i]=s,this.builder=new o.TransferSudtPwBuilder(e,t,n)}async build(){const e=await this.signer.getAddress();if(this.options.recipient===e)throw new i.RecipientSameWithSenderError({address:e});const t=await this.builder.build(),n=await new s.PwAdapterSigner(this.signer,this.provider).sign(t);return r.transformers.TransformTransaction(n)}}},929:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransferSudtPwBuilder=void 0;var r=n(16),i=n(197),s=n(194),o=n(324);class c extends o.AbstractPwSenderBuilder{constructor(e,t,n){super(t),this.options=e,this.signer=n}async build(){const{sudt:e,recipient:t,amount:n}=this.options,o=await this.signer.getAddress(),c=await this.provider.collectUdtCells(o,e,n),a=(await this.provider.collectUdtCells(t,e,"0"))[0],u=await this.getCellDeps();a||(0,s.boom)(`recipient ${t} has no cell to carry the udt`);const l=c.map((e=>new r.Cell(new r.Amount(e.output.capacity,0),i.Pw.toPwScript(e.output.lock),e.output.type&&i.Pw.toPwScript(e.output.type),i.Pw.toPwOutPoint(e.out_point),e.output_data))),d=new r.Cell(new r.Amount(a.output.capacity,0),i.Pw.toPwScript(a.output.lock),a.output.type&&i.Pw.toPwScript(a.output.type),i.Pw.toPwOutPoint(a.out_point),a.output_data),p=d.clone();p.setSUDTAmount(p.getSUDTAmount().add(new r.Amount(this.options.amount,0)));const f=l.reduce(((e,t)=>(e.capacity=e.capacity.add(t.capacity),e.setSUDTAmount(e.getSUDTAmount().add(t.getSUDTAmount())),e)));f.setSUDTAmount(f.getSUDTAmount().sub(new r.Amount(this.options.amount,0)));const h=new r.Transaction(new r.RawTransaction([...l,d],[f,p],u),l.map((()=>this.getWitnessPlaceholder(o)))),b=r.Builder.calcFee(h,Number(this.provider.config.MIN_FEE_RATE));return f.capacity=f.capacity.sub(b),f.availableFee().lte(r.Amount.ZERO)&&(0,s.boom)("only the additional capacity of the sudt cell is supported as a fee"),h}}t.TransferSudtPwBuilder=c},930:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellDeps=function(){if("undefined"===typeof window)return[];let e=i;false;return console.log("[cells]:",false,e),e},t.nets=void 0;var r=n(16);t.nets=[{name:"dev",url:"https://id.unipass.vip",model:1},{name:"Aggron-Preview",url:"https://t.unipass.xyz",model:0},{name:"Lina-Preview",url:"https://rc.unipass.xyz",model:0},{name:"Lina",url:"https://unipass.xyz"}];const i=[new r.CellDep(r.DepType.code,new r.OutPoint("0x04a1ac7fe15e454741d3c5c9a409efb9a967714ad2f530870514417978a9f655","0x0")),new r.CellDep(r.DepType.code,new r.OutPoint("0x03dd2a5594ed2d79196b396c83534e050ba0ad07fa5c1cd61a7094f9fb60a592","0x0")),new r.CellDep(r.DepType.code,new r.OutPoint("0xd346695aa3293a84e9f985448668e9692892c959e7e83d6d8042e59c08b8cf5c","0x0")),new r.CellDep(r.DepType.code,new r.OutPoint("0x194a0f84de41d006a07ece07c96a8130100818599fcf0b2ecf49e512b873ed6e","0x2"))];new r.CellDep(r.DepType.code,new r.OutPoint("0x5c98197999d04fbfa5eb579d0f1c85a3edac2b2f72164f2fc618b101adc71729","0x0")),new r.CellDep(r.DepType.code,new r.OutPoint("0xf247a0e9dfe9d559ad8486428987071b65d441568075465c2810409e889f4081","0x0")),new r.CellDep(r.DepType.code,new r.OutPoint("0x1196caaf9e45f1959ea3583f92914ee8306d42e27152f7068f9eeb52ac23eeae","0x0")),new r.CellDep(r.DepType.code,new r.OutPoint("0xf5edd047b3dbd676c9aa1e5a77ff32e3661d154c306e23bb0c13f8da9133f145","0x2"))},931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransferCkbBuilder=void 0;var r=n(16),i=n(137),s=n(323),o=n(932);t.TransferCkbBuilder=class{constructor(e,t,n){this.options=e,this.provider=t,this.signer=n}async build(){const e=await this.signer.getAddress();if(this.options.recipients.some((t=>t.recipient===e&&"findAcp"===t.capacityPolicy)))throw new i.RecipientSameWithSenderError({address:e});const t=new o.TransferCkbPwBuilder(this.options,this.provider,this.signer),n=await t.build(),c=await new s.PwAdapterSigner(this.signer,this.provider).sign(n);return r.transformers.TransformTransaction(c)}}},932:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransferCkbPwBuilder=void 0;var r=n(16),i=n(329),s=n(137),o=n(197),c=n(477),a=n(324);class u extends a.AbstractPwSenderBuilder{constructor(e,t,n){super(t),this.options=e,this.signer=n}async build(){const e=this.options.recipients.filter((e=>"createAcp"===e.capacityPolicy)).map((e=>new r.Cell(new r.Amount(e.amount,0),o.Pw.toPwScript(this.provider.parseToScript(e.recipient))))),t=this.options.recipients.filter((e=>"findAcp"===e.capacityPolicy)),n=(0,i.from)(t).pipe((0,i.mergeMap)((async e=>{const t=(await this.provider.collectCkbLiveCells(e.recipient,"0"))[0];if(!t)throw new s.NoAvailableCellError({lock:this.provider.parseToScript(e.recipient)});const n=o.Pw.toPwCell(t);return n.capacity=n.capacity.add(new r.Amount(e.amount,0)),n})),(0,i.toArray)()),a=await(0,i.lastValueFrom)(n),l=e.reduce(((e,t)=>e.add(t.capacity)),r.Amount.ZERO),d=t.reduce(((e,t)=>e.add(new r.Amount(t.amount,0))),r.Amount.ZERO),p=(await this.provider.collectCkbLiveCells(await this.signer.getAddress(),d.add(l).add(new r.Amount(String((0,c.byteLenOfCkbLiveCell)()))).add(new r.Amount("1")).toHexString())).map(o.Pw.toPwCell);if(!p.length||!p[0])throw new s.NoAvailableCellError({lock:this.provider.parseToScript(await this.signer.getAddress())});const f=p[0],h=new r.Transaction(new r.RawTransaction([...p,...a],[f,...a,...e],this.getCellDeps()),[this.getWitnessPlaceholder(await this.signer.getAddress())]),b=u.calcFee(h);return f.capacity=f.capacity.sub(l).sub(d).sub(b),h}}t.TransferCkbPwBuilder=u},933:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MintSudtBuilder=void 0;var r=n(16),i=n(137),s=n(934),o=n(323);t.MintSudtBuilder=class{constructor(e,t,n){this.options=e,this.provider=t,this.signer=n}async build(){const e=await this.signer.getAddress(),t=new s.NonAcpPwMintBuilder(this.options,this.provider,e);if(this.options.recipients.some((t=>t.recipient===e&&"findAcp"===t.capacityPolicy)))throw new i.RecipientSameWithSenderError({address:e});const n=await t.build(),c=await new o.PwAdapterSigner(this.signer,this.provider).sign(n);return r.transformers.TransformTransaction(c)}}},934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonAcpPwMintBuilder=void 0;var r=n(16),i=n(329),s=n(137),o=n(197),c=n(477),a=n(324);class u extends a.AbstractPwSenderBuilder{constructor(e,t,n){super(t),this.options=e,this.issuerAddress=n}async build(){const e=this.provider.newSudtScript(this.issuerAddress),t=this.options.recipients.filter((e=>"createAcp"===e.capacityPolicy)).map((t=>new r.Cell(new r.Amount(String(BigInt(t.additionalCapacity||0)),0).add(new r.Amount(String((0,c.byteLenOfSudt)()))),o.Pw.toPwScript(this.provider.parseToScript(t.recipient)),o.Pw.toPwScript(e),void 0,new r.Amount(t.amount,0).toUInt128LE()))),n=this.options.recipients.filter((e=>"findAcp"===e.capacityPolicy)),a=(0,i.from)(n).pipe((0,i.mergeMap)((async t=>{const n=(await this.provider.collectUdtCells(t.recipient,e,"0"))[0];if(!n)throw new s.NoAvailableCellError({lock:this.provider.parseToScript(t.recipient),type:e});const i=o.Pw.toPwCell(n);return i.capacity=i.capacity.add(new r.Amount(t.additionalCapacity||"0",0)),i.setSUDTAmount(i.getSUDTAmount().add(new r.Amount(t.amount,0))),i}),5),(0,i.toArray)()),u=await(0,i.lastValueFrom)(a),l=t.reduce(((e,t)=>e.add(t.capacity)),r.Amount.ZERO),d=n.reduce(((e,t)=>e.add(new r.Amount(t.additionalCapacity||"0",0))),r.Amount.ZERO),p=l.add(d).add(new r.Amount(String((0,c.byteLenOfCkbLiveCell)()))).add(new r.Amount("1")),f=(await this.provider.collectCkbLiveCells(this.issuerAddress,p.toHexString())).map(o.Pw.toPwCell),h=f[0].clone();h.capacity=f.reduce(((e,t)=>e.add(t.capacity)),r.Amount.ZERO);const b=new r.RawTransaction([...f,...u],[h,...t,...u],this.getCellDeps()),g=new r.Transaction(b,[this.getWitnessPlaceholder(this.issuerAddress)]),m=r.Builder.calcFee(g,Number(this.provider.config.MIN_FEE_RATE));return h.capacity=h.capacity.sub(m).sub(l).sub(d),g}}t.NonAcpPwMintBuilder=u},935:function(e,t,n){"use strict";function r(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.predefined=void 0;const i={Aggron:{PREFIX:"ckt",SCRIPTS:function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=s?Object.getOwnPropertyDescriptor(e,o):null;c&&(c.get||c.set)?Object.defineProperty(i,o,c):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(n(936)).SCRIPTS}};t.predefined=i},936:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCRIPTS=void 0;var r=n(279);const i={SECP256K1_BLAKE160:r.predefined.AGGRON4.SCRIPTS.SECP256K1_BLAKE160,ANYONE_CAN_PAY:r.predefined.AGGRON4.SCRIPTS.ANYONE_CAN_PAY,SUDT:r.predefined.AGGRON4.SCRIPTS.SUDT,PW_ANYONE_CAN_PAY:{CODE_HASH:"0x093ba9759e1c4a79dd81b0a50de83ab108ffe4eb983b05637bf1f5c1834f31eb",HASH_TYPE:"data",TX_HASH:"0x834d1827950545da5cca779903ca8268aecbc7bfadb1d1cc18ba90f3b312cd41",INDEX:"0x2",DEP_TYPE:"code"},PW_NON_ANYONE_CAN_PAY:{CODE_HASH:"0x87366c3678f14ccbd6647386a18e05ae27c97978d4a6952fb5820cc698263835",HASH_TYPE:"data",TX_HASH:"0x834d1827950545da5cca779903ca8268aecbc7bfadb1d1cc18ba90f3b312cd41",INDEX:"0x3",DEP_TYPE:"code"},UNIPASS:{INDEX:"0x0",TX_HASH:"0x03dd2a5594ed2d79196b396c83534e050ba0ad07fa5c1cd61a7094f9fb60a592",DEP_TYPE:"code",CODE_HASH:"0x124a60cd799e1fbca664196de46b3f7f0ecb7138133dcaea4893c51df5b02be6",HASH_TYPE:"type"}};t.SCRIPTS=i},937:function(e,t,n){"use strict";var r=n(341),i=n(343),s=n(212),o=n(213),c=n(210),a=n(211);Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedDummyWallet=t.DummyWallet=void 0;var u=function(e){c(n,e);var t=a(n);function n(){var e;return s(this,n),(e=t.call(this)).setDescriptor({name:"DummyWallet"}),e}return o(n,[{key:"connect",value:function(){var e=this;"disconnected"===this.connectStatus&&(this.onConnectStatusChanged("connecting"),setTimeout((function(){"connecting"===e.connectStatus&&(e.onConnectStatusChanged("connected"),e.onSignerChanged(new l))}),500))}}]),n}(n(177).AbstractWallet);t.DummyWallet=u;var l=function(){function e(){s(this,e)}return o(e,[{key:"getAddress",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","ckt1qj2fmdr6437352sdjgf5fhzurh00mgussyap3qw4dgy894ucurtzj0zrsk22amhe0evutcsup8ydmshf47t9xhsnl9c");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","0x");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),d=function(e){c(n,e);var t=a(n);function n(){var e;return s(this,n),(e=t.call(this)).setDescriptor({name:"ExtendedDummyWallet",features:["unknown-feature"]}),e}return n}(u);t.ExtendedDummyWallet=d}},[[1016,1,2]]]);
//# sourceMappingURL=main.537becdb.chunk.js.map